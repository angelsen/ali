name: tmux
version: 2.0
description: Terminal multiplexer - pane and window management
provides:
  pane:
    type: service
    capabilities: [create, split, focus, close]
  window:
    type: service
    capabilities: [create, focus, close]
  session:
    type: service
    capabilities: [create, switch, close]
context:
  requires_env: TMUX
vocabulary:
  verbs: [GO, DELETE, SPLIT, CREATE, WIDTH, HEIGHT]
  objects: [PANE, WINDOW, SESSION]
  directions: [left, right, up, down]
  clauses: [AS] # For WIDTH 012 AS 1/2
# Token patterns this plugin recognizes
patterns:
  - field: target
    regex: "^\\."
    description: "Pane selectors (.1, .left, .?)"
  - field: target
    regex: "^:"
    description: "Window selectors (:1, :?)"
  - field: target
    keywords: ["?", "THIS", "CURRENT"]
    description: "Special selectors"
# Verb expectations
expectations:
  GO: [target]
  DELETE: ["object?", "target?"]
  SPLIT: ["direction?"]
  CREATE: [object, "direction?"]
  WIDTH: [panes, "clause?", "fraction?"] # WIDTH 012 or WIDTH 012 AS 1/2
  HEIGHT: [panes, "clause?", "fraction?"] # HEIGHT 012 or HEIGHT 012 AS 1/2
# Safe inference rules
inference:
  # GO ? â†’ visual pane selector
  - when: {verb: GO, target: "?"}
    transform: {target: ".?"}
  # Target prefix implies object
  - when: {verb: DELETE, target: "^\\.", object: null}
    set: {object: PANE}
  - when: {verb: DELETE, target: "^:", object: null}
    set: {object: WINDOW}
  # SPLIT always means pane
  - when: {verb: SPLIT}
    set: {object: PANE}
commands:
  # Navigation
  - match: {verb: GO, target: ".?"}
    exec: "tmux display-panes"
  - match: {verb: GO, target: present}
    exec: "tmux select-pane -t {target}"
  # Pane operations
  - match: {verb: SPLIT, object: PANE, direction: left}
    exec: "tmux split-window -h -b"
  - match: {verb: SPLIT, object: PANE, direction: right}
    exec: "tmux split-window -h"
  - match: {verb: SPLIT, object: PANE}
    exec: "tmux split-window -h"
  - match: {verb: DELETE, object: PANE, target: present}
    exec: "tmux kill-pane -t {target}"
  # Window operations
  - match: {verb: CREATE, object: WINDOW}
    exec: "tmux new-window"
  - match: {verb: DELETE, object: WINDOW, target: present}
    exec: "tmux kill-window -t {target}"
  # Pane distribution commands
  - match: {verb: WIDTH, panes: present, fraction: present}
    exec: "ali --plugin-script tmux.distribute --dimension width --panes {panes} --fraction {fraction}"
  - match: {verb: WIDTH, panes: present}
    exec: "ali --plugin-script tmux.distribute --dimension width --panes {panes}"
  - match: {verb: HEIGHT, panes: present, fraction: present}
    exec: "ali --plugin-script tmux.distribute --dimension height --panes {panes} --fraction {fraction}"
  - match: {verb: HEIGHT, panes: present}
    exec: "ali --plugin-script tmux.distribute --dimension height --panes {panes}"
# Service templates for other plugins to use
service_templates:
  pane:
    create: "tmux split-window {options}"
    create_left: "tmux split-window -h -b -l {size}"
    create_right: "tmux split-window -h -l {size}"
    create_bottom: "tmux split-window -v -l {size}"
    focus: "tmux select-pane -t {target}"
